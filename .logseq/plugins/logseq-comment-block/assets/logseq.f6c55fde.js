var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vn={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */(function(At,Ft){(function(dn,ke){At.exports=ke()})(self,function(){return(()=>{var dn={227:($,u,C)=>{var T=C(155);u.formatArgs=function(F){if(F[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+F[0]+(this.useColors?"%c ":" ")+"+"+$.exports.humanize(this.diff),!this.useColors)return;const E="color: "+this.color;F.splice(1,0,E,"color: inherit");let p=0,l=0;F[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(p++,m==="%c"&&(l=p))}),F.splice(l,0,E)},u.save=function(F){try{F?u.storage.setItem("debug",F):u.storage.removeItem("debug")}catch{}},u.load=function(){let F;try{F=u.storage.getItem("debug")}catch{}return!F&&T!==void 0&&"env"in T&&(F=T.env.DEBUG),F},u.useColors=function(){return!(typeof window>"u"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator>"u"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},u.storage=function(){try{return localStorage}catch{}}(),u.destroy=(()=>{let F=!1;return()=>{F||(F=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),u.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],u.log=console.debug||console.log||(()=>{}),$.exports=C(447)(u);const{formatters:b}=$.exports;b.j=function(F){try{return JSON.stringify(F)}catch(E){return"[UnexpectedJSONParseError]: "+E.message}}},447:($,u,C)=>{$.exports=function(T){function b(p){let l,m=null;function d(...I){if(!d.enabled)return;const U=d,D=Number(new Date),B=D-(l||D);U.diff=B,U.prev=l,U.curr=D,l=D,I[0]=b.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let _=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(j,i)=>{if(j==="%%")return"%";_++;const a=b.formatters[i];if(typeof a=="function"){const f=I[_];j=a.call(U,f),I.splice(_,1),_--}return j}),b.formatArgs.call(U,I),(U.log||b.log).apply(U,I)}return d.namespace=p,d.useColors=b.useColors(),d.color=b.selectColor(p),d.extend=F,d.destroy=b.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>m===null?b.enabled(p):m,set:I=>{m=I}}),typeof b.init=="function"&&b.init(d),d}function F(p,l){const m=b(this.namespace+(l===void 0?":":l)+p);return m.log=this.log,m}function E(p){return p.toString().substring(2,p.toString().length-2).replace(/\.\*\?$/,"*")}return b.debug=b,b.default=b,b.coerce=function(p){return p instanceof Error?p.stack||p.message:p},b.disable=function(){const p=[...b.names.map(E),...b.skips.map(E).map(l=>"-"+l)].join(",");return b.enable(""),p},b.enable=function(p){let l;b.save(p),b.names=[],b.skips=[];const m=(typeof p=="string"?p:"").split(/[\s,]+/),d=m.length;for(l=0;l<d;l++)m[l]&&((p=m[l].replace(/\*/g,".*?"))[0]==="-"?b.skips.push(new RegExp("^"+p.substr(1)+"$")):b.names.push(new RegExp("^"+p+"$")))},b.enabled=function(p){if(p[p.length-1]==="*")return!0;let l,m;for(l=0,m=b.skips.length;l<m;l++)if(b.skips[l].test(p))return!1;for(l=0,m=b.names.length;l<m;l++)if(b.names[l].test(p))return!0;return!1},b.humanize=C(824),b.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(T).forEach(p=>{b[p]=T[p]}),b.names=[],b.skips=[],b.formatters={},b.selectColor=function(p){let l=0;for(let m=0;m<p.length;m++)l=(l<<5)-l+p.charCodeAt(m),l|=0;return b.colors[Math.abs(l)%b.colors.length]},b.enable(b.load()),b}},856:function($){$.exports=function(){var u=Object.hasOwnProperty,C=Object.setPrototypeOf,T=Object.isFrozen,b=Object.getPrototypeOf,F=Object.getOwnPropertyDescriptor,E=Object.freeze,p=Object.seal,l=Object.create,m=typeof Reflect<"u"&&Reflect,d=m.apply,I=m.construct;d||(d=function(R,N,A){return R.apply(N,A)}),E||(E=function(R){return R}),p||(p=function(R){return R}),I||(I=function(R,N){return new(Function.prototype.bind.apply(R,[null].concat(function(A){if(Array.isArray(A)){for(var Q=0,tt=Array(A.length);Q<A.length;Q++)tt[Q]=A[Q];return tt}return Array.from(A)}(N))))});var U,D=W(Array.prototype.forEach),B=W(Array.prototype.pop),_=W(Array.prototype.push),j=W(String.prototype.toLowerCase),i=W(String.prototype.match),a=W(String.prototype.replace),f=W(String.prototype.indexOf),x=W(String.prototype.trim),H=W(RegExp.prototype.test),q=(U=TypeError,function(){for(var R=arguments.length,N=Array(R),A=0;A<R;A++)N[A]=arguments[A];return I(U,N)});function W(R){return function(N){for(var A=arguments.length,Q=Array(A>1?A-1:0),tt=1;tt<A;tt++)Q[tt-1]=arguments[tt];return d(R,N,Q)}}function M(R,N){C&&C(R,null);for(var A=N.length;A--;){var Q=N[A];if(typeof Q=="string"){var tt=j(Q);tt!==Q&&(T(N)||(N[A]=tt),Q=tt)}R[Q]=!0}return R}function nt(R){var N=l(null),A=void 0;for(A in R)d(u,R,[A])&&(N[A]=R[A]);return N}function at(R,N){for(;R!==null;){var A=F(R,N);if(A){if(A.get)return W(A.get);if(typeof A.value=="function")return W(A.value)}R=b(R)}return function(Q){return console.warn("fallback value for",Q),null}}var Tt=E(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Rt=E(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),s=E(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),y=E(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),k=E(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),X=E(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),dt=E(["#text"]),rt=E(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),G=E(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),et=E(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ot=E(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),st=p(/\{\{[\s\S]*|[\s\S]*\}\}/gm),zt=p(/<%[\s\S]*|[\s\S]*%>/gm),vt=p(/^data-[\-\w.\u00B7-\uFFFF]/),it=p(/^aria-[\-\w]+$/),Z=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ht=p(/^(?:\w+script|data):/i),wt=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R};function lt(R){if(Array.isArray(R)){for(var N=0,A=Array(R.length);N<R.length;N++)A[N]=R[N];return A}return Array.from(R)}var Et=function(){return typeof window>"u"?null:window},Xt=function(R,N){if((R===void 0?"undefined":bt(R))!=="object"||typeof R.createPolicy!="function")return null;var A=null,Q="data-tt-policy-suffix";N.currentScript&&N.currentScript.hasAttribute(Q)&&(A=N.currentScript.getAttribute(Q));var tt="dompurify"+(A?"#"+A:"");try{return R.createPolicy(tt,{createHTML:function(Dt){return Dt}})}catch{return console.warn("TrustedTypes policy "+tt+" could not be created."),null}};return function R(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Et(),A=function(r){return R(r)};if(A.version="2.3.1",A.removed=[],!N||!N.document||N.document.nodeType!==9)return A.isSupported=!1,A;var Q=N.document,tt=N.document,Dt=N.DocumentFragment,Fe=N.HTMLTemplateElement,qt=N.Node,Ee=N.Element,Qt=N.NodeFilter,Ut=N.NamedNodeMap,Le=Ut===void 0?N.NamedNodeMap||N.MozNamedAttrMap:Ut,Ie=N.Text,nn=N.Comment,rn=N.DOMParser,ge=N.trustedTypes,Pt=Ee.prototype,Me=at(Pt,"cloneNode"),ye=at(Pt,"nextSibling"),Ne=at(Pt,"childNodes"),te=at(Pt,"parentNode");if(typeof Fe=="function"){var ee=tt.createElement("template");ee.content&&ee.content.ownerDocument&&(tt=ee.content.ownerDocument)}var Ct=Xt(ge,Q),Re=Ct&&Zt?Ct.createHTML(""):"",ne=tt,re=ne.implementation,on=ne.createNodeIterator,an=ne.createDocumentFragment,V=ne.getElementsByTagName,ze=Q.importNode,$t={};try{$t=nt(tt).documentMode?tt.documentMode:{}}catch{}var yt={};A.isSupported=typeof te=="function"&&re&&re.createHTMLDocument!==void 0&&$t!==9;var oe=st,ie=zt,De=vt,ve=it,sn=ht,Ue=wt,be=Z,ct=null,Pe=M({},[].concat(lt(Tt),lt(Rt),lt(s),lt(k),lt(dt))),ut=null,$e=M({},[].concat(lt(rt),lt(G),lt(et),lt(ot))),_e=null,ae=null,He=!0,we=!0,Be=!1,Lt=!1,Ht=!1,se=!1,Ce=!1,Bt=!1,ce=!1,We=!0,Zt=!1,le=!0,xe=!0,It=!1,Wt={},Mt=null,jt=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ge=null,Je=M({},["audio","video","img","source","image","track"]),Vt=null,qe=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",Oe="http://www.w3.org/2000/svg",kt="http://www.w3.org/1999/xhtml",ue=kt,fe=!1,Gt=null,cn=tt.createElement("form"),Ae=function(r){Gt&&Gt===r||(r&&(r===void 0?"undefined":bt(r))==="object"||(r={}),r=nt(r),ct="ALLOWED_TAGS"in r?M({},r.ALLOWED_TAGS):Pe,ut="ALLOWED_ATTR"in r?M({},r.ALLOWED_ATTR):$e,Vt="ADD_URI_SAFE_ATTR"in r?M(nt(qe),r.ADD_URI_SAFE_ATTR):qe,Ge="ADD_DATA_URI_TAGS"in r?M(nt(Je),r.ADD_DATA_URI_TAGS):Je,Mt="FORBID_CONTENTS"in r?M({},r.FORBID_CONTENTS):jt,_e="FORBID_TAGS"in r?M({},r.FORBID_TAGS):{},ae="FORBID_ATTR"in r?M({},r.FORBID_ATTR):{},Wt="USE_PROFILES"in r&&r.USE_PROFILES,He=r.ALLOW_ARIA_ATTR!==!1,we=r.ALLOW_DATA_ATTR!==!1,Be=r.ALLOW_UNKNOWN_PROTOCOLS||!1,Lt=r.SAFE_FOR_TEMPLATES||!1,Ht=r.WHOLE_DOCUMENT||!1,Bt=r.RETURN_DOM||!1,ce=r.RETURN_DOM_FRAGMENT||!1,We=r.RETURN_DOM_IMPORT!==!1,Zt=r.RETURN_TRUSTED_TYPE||!1,Ce=r.FORCE_BODY||!1,le=r.SANITIZE_DOM!==!1,xe=r.KEEP_CONTENT!==!1,It=r.IN_PLACE||!1,be=r.ALLOWED_URI_REGEXP||be,ue=r.NAMESPACE||kt,Lt&&(we=!1),ce&&(Bt=!0),Wt&&(ct=M({},[].concat(lt(dt))),ut=[],Wt.html===!0&&(M(ct,Tt),M(ut,rt)),Wt.svg===!0&&(M(ct,Rt),M(ut,G),M(ut,ot)),Wt.svgFilters===!0&&(M(ct,s),M(ut,G),M(ut,ot)),Wt.mathMl===!0&&(M(ct,k),M(ut,et),M(ut,ot))),r.ADD_TAGS&&(ct===Pe&&(ct=nt(ct)),M(ct,r.ADD_TAGS)),r.ADD_ATTR&&(ut===$e&&(ut=nt(ut)),M(ut,r.ADD_ATTR)),r.ADD_URI_SAFE_ATTR&&M(Vt,r.ADD_URI_SAFE_ATTR),r.FORBID_CONTENTS&&(Mt===jt&&(Mt=nt(Mt)),M(Mt,r.FORBID_CONTENTS)),xe&&(ct["#text"]=!0),Ht&&M(ct,["html","head","body"]),ct.table&&(M(ct,["tbody"]),delete _e.tbody),E&&E(r),Gt=r)},Ze=M({},["mi","mo","mn","ms","mtext"]),xt=M({},["foreignobject","desc","title","annotation-xml"]),Nt=M({},Rt);M(Nt,s),M(Nt,y);var pe=M({},k);M(pe,X);var de=function(r){var S=te(r);S&&S.tagName||(S={namespaceURI:kt,tagName:"template"});var v=j(r.tagName),J=j(S.tagName);if(r.namespaceURI===Oe)return S.namespaceURI===kt?v==="svg":S.namespaceURI===Se?v==="svg"&&(J==="annotation-xml"||Ze[J]):Boolean(Nt[v]);if(r.namespaceURI===Se)return S.namespaceURI===kt?v==="math":S.namespaceURI===Oe?v==="math"&&xt[J]:Boolean(pe[v]);if(r.namespaceURI===kt){if(S.namespaceURI===Oe&&!xt[J]||S.namespaceURI===Se&&!Ze[J])return!1;var K=M({},["title","style","font","a","script"]);return!pe[v]&&(K[v]||!Nt[v])}return!1},St=function(r){_(A.removed,{element:r});try{r.parentNode.removeChild(r)}catch{try{r.outerHTML=Re}catch{r.remove()}}},he=function(r,S){try{_(A.removed,{attribute:S.getAttributeNode(r),from:S})}catch{_(A.removed,{attribute:null,from:S})}if(S.removeAttribute(r),r==="is"&&!ut[r])if(Bt||ce)try{St(S)}catch{}else try{S.setAttribute(r,"")}catch{}},Ve=function(r){var S=void 0,v=void 0;if(Ce)r="<remove></remove>"+r;else{var J=i(r,/^[\r\n\t ]+/);v=J&&J[0]}var K=Ct?Ct.createHTML(r):r;if(ue===kt)try{S=new rn().parseFromString(K,"text/html")}catch{}if(!S||!S.documentElement){S=re.createDocument(ue,"template",null);try{S.documentElement.innerHTML=fe?"":K}catch{}}var e=S.body||S.documentElement;return r&&v&&e.insertBefore(tt.createTextNode(v),e.childNodes[0]||null),ue===kt?V.call(S,Ht?"html":"body")[0]:Ht?S.documentElement:e},Ke=function(r){return on.call(r.ownerDocument||r,r,Qt.SHOW_ELEMENT|Qt.SHOW_COMMENT|Qt.SHOW_TEXT,null,!1)},ln=function(r){return!(r instanceof Ie||r instanceof nn||typeof r.nodeName=="string"&&typeof r.textContent=="string"&&typeof r.removeChild=="function"&&r.attributes instanceof Le&&typeof r.removeAttribute=="function"&&typeof r.setAttribute=="function"&&typeof r.namespaceURI=="string"&&typeof r.insertBefore=="function")},Jt=function(r){return(qt===void 0?"undefined":bt(qt))==="object"?r instanceof qt:r&&(r===void 0?"undefined":bt(r))==="object"&&typeof r.nodeType=="number"&&typeof r.nodeName=="string"},Ot=function(r,S,v){yt[r]&&D(yt[r],function(J){J.call(A,S,v,Gt)})},Ye=function(r){var S=void 0;if(Ot("beforeSanitizeElements",r,null),ln(r)||i(r.nodeName,/[\u0080-\uFFFF]/))return St(r),!0;var v=j(r.nodeName);if(Ot("uponSanitizeElement",r,{tagName:v,allowedTags:ct}),!Jt(r.firstElementChild)&&(!Jt(r.content)||!Jt(r.content.firstElementChild))&&H(/<[/\w]/g,r.innerHTML)&&H(/<[/\w]/g,r.textContent)||v==="select"&&H(/<template/i,r.innerHTML))return St(r),!0;if(!ct[v]||_e[v]){if(xe&&!Mt[v]){var J=te(r)||r.parentNode,K=Ne(r)||r.childNodes;if(K&&J)for(var e=K.length-1;e>=0;--e)J.insertBefore(Me(K[e],!0),ye(r))}return St(r),!0}return r instanceof Ee&&!de(r)?(St(r),!0):v!=="noscript"&&v!=="noembed"||!H(/<\/no(script|embed)/i,r.innerHTML)?(Lt&&r.nodeType===3&&(S=r.textContent,S=a(S,oe," "),S=a(S,ie," "),r.textContent!==S&&(_(A.removed,{element:r.cloneNode()}),r.textContent=S)),Ot("afterSanitizeElements",r,null),!1):(St(r),!0)},Xe=function(r,S,v){if(le&&(S==="id"||S==="name")&&(v in tt||v in cn))return!1;if(!(we&&!ae[S]&&H(De,S))){if(!(He&&H(ve,S))){if(!ut[S]||ae[S])return!1;if(!Vt[S]){if(!H(be,a(v,Ue,""))){if((S!=="src"&&S!=="xlink:href"&&S!=="href"||r==="script"||f(v,"data:")!==0||!Ge[r])&&!(Be&&!H(sn,a(v,Ue,"")))){if(v)return!1}}}}}return!0},Kt=function(r){var S=void 0,v=void 0,J=void 0,K=void 0;Ot("beforeSanitizeAttributes",r,null);var e=r.attributes;if(e){var t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ut};for(K=e.length;K--;){var n=S=e[K],o=n.name,c=n.namespaceURI;if(v=x(S.value),J=j(o),t.attrName=J,t.attrValue=v,t.keepAttr=!0,t.forceKeepAttr=void 0,Ot("uponSanitizeAttribute",r,t),v=t.attrValue,!t.forceKeepAttr&&(he(o,r),t.keepAttr))if(H(/\/>/i,v))he(o,r);else{Lt&&(v=a(v,oe," "),v=a(v,ie," "));var h=r.nodeName.toLowerCase();if(Xe(h,J,v))try{c?r.setAttributeNS(c,o,v):r.setAttribute(o,v),B(A.removed)}catch{}}}Ot("afterSanitizeAttributes",r,null)}},un=function r(S){var v=void 0,J=Ke(S);for(Ot("beforeSanitizeShadowDOM",S,null);v=J.nextNode();)Ot("uponSanitizeShadowNode",v,null),Ye(v)||(v.content instanceof Dt&&r(v.content),Kt(v));Ot("afterSanitizeShadowDOM",S,null)};return A.sanitize=function(r,S){var v=void 0,J=void 0,K=void 0,e=void 0,t=void 0;if((fe=!r)&&(r="<!-->"),typeof r!="string"&&!Jt(r)){if(typeof r.toString!="function")throw q("toString is not a function");if(typeof(r=r.toString())!="string")throw q("dirty is not a string, aborting")}if(!A.isSupported){if(bt(N.toStaticHTML)==="object"||typeof N.toStaticHTML=="function"){if(typeof r=="string")return N.toStaticHTML(r);if(Jt(r))return N.toStaticHTML(r.outerHTML)}return r}if(se||Ae(S),A.removed=[],typeof r=="string"&&(It=!1),!It)if(r instanceof qt)(J=(v=Ve("<!---->")).ownerDocument.importNode(r,!0)).nodeType===1&&J.nodeName==="BODY"||J.nodeName==="HTML"?v=J:v.appendChild(J);else{if(!Bt&&!Lt&&!Ht&&r.indexOf("<")===-1)return Ct&&Zt?Ct.createHTML(r):r;if(!(v=Ve(r)))return Bt?null:Re}v&&Ce&&St(v.firstChild);for(var n=Ke(It?r:v);K=n.nextNode();)K.nodeType===3&&K===e||Ye(K)||(K.content instanceof Dt&&un(K.content),Kt(K),e=K);if(e=null,It)return r;if(Bt){if(ce)for(t=an.call(v.ownerDocument);v.firstChild;)t.appendChild(v.firstChild);else t=v;return We&&(t=ze.call(Q,t,!0)),t}var o=Ht?v.outerHTML:v.innerHTML;return Lt&&(o=a(o,oe," "),o=a(o,ie," ")),Ct&&Zt?Ct.createHTML(o):o},A.setConfig=function(r){Ae(r),se=!0},A.clearConfig=function(){Gt=null,se=!1},A.isValidAttribute=function(r,S,v){Gt||Ae({});var J=j(r),K=j(S);return Xe(J,K,v)},A.addHook=function(r,S){typeof S=="function"&&(yt[r]=yt[r]||[],_(yt[r],S))},A.removeHook=function(r){yt[r]&&B(yt[r])},A.removeHooks=function(r){yt[r]&&(yt[r]=[])},A.removeAllHooks=function(){yt={}},A}()}()},729:$=>{var u=Object.prototype.hasOwnProperty,C="~";function T(){}function b(l,m,d){this.fn=l,this.context=m,this.once=d||!1}function F(l,m,d,I,U){if(typeof d!="function")throw new TypeError("The listener must be a function");var D=new b(d,I||l,U),B=C?C+m:m;return l._events[B]?l._events[B].fn?l._events[B]=[l._events[B],D]:l._events[B].push(D):(l._events[B]=D,l._eventsCount++),l}function E(l,m){--l._eventsCount==0?l._events=new T:delete l._events[m]}function p(){this._events=new T,this._eventsCount=0}Object.create&&(T.prototype=Object.create(null),new T().__proto__||(C=!1)),p.prototype.eventNames=function(){var l,m,d=[];if(this._eventsCount===0)return d;for(m in l=this._events)u.call(l,m)&&d.push(C?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(l)):d},p.prototype.listeners=function(l){var m=C?C+l:l,d=this._events[m];if(!d)return[];if(d.fn)return[d.fn];for(var I=0,U=d.length,D=new Array(U);I<U;I++)D[I]=d[I].fn;return D},p.prototype.listenerCount=function(l){var m=C?C+l:l,d=this._events[m];return d?d.fn?1:d.length:0},p.prototype.emit=function(l,m,d,I,U,D){var B=C?C+l:l;if(!this._events[B])return!1;var _,j,i=this._events[B],a=arguments.length;if(i.fn){switch(i.once&&this.removeListener(l,i.fn,void 0,!0),a){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,m),!0;case 3:return i.fn.call(i.context,m,d),!0;case 4:return i.fn.call(i.context,m,d,I),!0;case 5:return i.fn.call(i.context,m,d,I,U),!0;case 6:return i.fn.call(i.context,m,d,I,U,D),!0}for(j=1,_=new Array(a-1);j<a;j++)_[j-1]=arguments[j];i.fn.apply(i.context,_)}else{var f,x=i.length;for(j=0;j<x;j++)switch(i[j].once&&this.removeListener(l,i[j].fn,void 0,!0),a){case 1:i[j].fn.call(i[j].context);break;case 2:i[j].fn.call(i[j].context,m);break;case 3:i[j].fn.call(i[j].context,m,d);break;case 4:i[j].fn.call(i[j].context,m,d,I);break;default:if(!_)for(f=1,_=new Array(a-1);f<a;f++)_[f-1]=arguments[f];i[j].fn.apply(i[j].context,_)}}return!0},p.prototype.on=function(l,m,d){return F(this,l,m,d,!1)},p.prototype.once=function(l,m,d){return F(this,l,m,d,!0)},p.prototype.removeListener=function(l,m,d,I){var U=C?C+l:l;if(!this._events[U])return this;if(!m)return E(this,U),this;var D=this._events[U];if(D.fn)D.fn!==m||I&&!D.once||d&&D.context!==d||E(this,U);else{for(var B=0,_=[],j=D.length;B<j;B++)(D[B].fn!==m||I&&!D[B].once||d&&D[B].context!==d)&&_.push(D[B]);_.length?this._events[U]=_.length===1?_[0]:_:E(this,U)}return this},p.prototype.removeAllListeners=function(l){var m;return l?(m=C?C+l:l,this._events[m]&&E(this,m)):(this._events=new T,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=C,p.EventEmitter=p,$.exports=p},717:$=>{typeof Object.create=="function"?$.exports=function(u,C){u.super_=C,u.prototype=Object.create(C.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}})}:$.exports=function(u,C){u.super_=C;var T=function(){};T.prototype=C.prototype,u.prototype=new T,u.prototype.constructor=u}},824:$=>{var u=1e3,C=60*u,T=60*C,b=24*T;function F(E,p,l,m){var d=p>=1.5*l;return Math.round(E/l)+" "+m+(d?"s":"")}$.exports=function(E,p){p=p||{};var l,m,d=typeof E;if(d==="string"&&E.length>0)return function(I){if(!((I=String(I)).length>100)){var U=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(I);if(U){var D=parseFloat(U[1]);switch((U[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*D;case"weeks":case"week":case"w":return 6048e5*D;case"days":case"day":case"d":return D*b;case"hours":case"hour":case"hrs":case"hr":case"h":return D*T;case"minutes":case"minute":case"mins":case"min":case"m":return D*C;case"seconds":case"second":case"secs":case"sec":case"s":return D*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return D;default:return}}}}(E);if(d==="number"&&isFinite(E))return p.long?(l=E,(m=Math.abs(l))>=b?F(l,m,b,"day"):m>=T?F(l,m,T,"hour"):m>=C?F(l,m,C,"minute"):m>=u?F(l,m,u,"second"):l+" ms"):function(I){var U=Math.abs(I);return U>=b?Math.round(I/b)+"d":U>=T?Math.round(I/T)+"h":U>=C?Math.round(I/C)+"m":U>=u?Math.round(I/u)+"s":I+"ms"}(E);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(E))}},520:($,u,C)=>{var T=C(155),b=T.platform==="win32",F=C(539);function E(i,a){for(var f=[],x=0;x<i.length;x++){var H=i[x];H&&H!=="."&&(H===".."?f.length&&f[f.length-1]!==".."?f.pop():a&&f.push(".."):f.push(H))}return f}function p(i){for(var a=i.length-1,f=0;f<=a&&!i[f];f++);for(var x=a;x>=0&&!i[x];x--);return f===0&&x===a?i:f>x?[]:i.slice(f,x+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,m=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,d={};function I(i){var a=l.exec(i),f=(a[1]||"")+(a[2]||""),x=a[3]||"",H=m.exec(x);return[f,H[1],H[2],H[3]]}function U(i){var a=l.exec(i),f=a[1]||"",x=!!f&&f[1]!==":";return{device:f,isUnc:x,isAbsolute:x||!!a[2],tail:a[3]}}function D(i){return"\\\\"+i.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}d.resolve=function(){for(var i="",a="",f=!1,x=arguments.length-1;x>=-1;x--){var H;if(x>=0?H=arguments[x]:i?(H=T.env["="+i])&&H.substr(0,3).toLowerCase()===i.toLowerCase()+"\\"||(H=i+"\\"):H=T.cwd(),!F.isString(H))throw new TypeError("Arguments to path.resolve must be strings");if(H){var q=U(H),W=q.device,M=q.isUnc,nt=q.isAbsolute,at=q.tail;if((!W||!i||W.toLowerCase()===i.toLowerCase())&&(i||(i=W),f||(a=at+"\\"+a,f=nt),i&&f))break}}return M&&(i=D(i)),i+(f?"\\":"")+(a=E(a.split(/[\\\/]+/),!f).join("\\"))||"."},d.normalize=function(i){var a=U(i),f=a.device,x=a.isUnc,H=a.isAbsolute,q=a.tail,W=/[\\\/]$/.test(q);return(q=E(q.split(/[\\\/]+/),!H).join("\\"))||H||(q="."),q&&W&&(q+="\\"),x&&(f=D(f)),f+(H?"\\":"")+q},d.isAbsolute=function(i){return U(i).isAbsolute},d.join=function(){for(var i=[],a=0;a<arguments.length;a++){var f=arguments[a];if(!F.isString(f))throw new TypeError("Arguments to path.join must be strings");f&&i.push(f)}var x=i.join("\\");return/^[\\\/]{2}[^\\\/]/.test(i[0])||(x=x.replace(/^[\\\/]{2,}/,"\\")),d.normalize(x)},d.relative=function(i,a){i=d.resolve(i),a=d.resolve(a);for(var f=i.toLowerCase(),x=a.toLowerCase(),H=p(a.split("\\")),q=p(f.split("\\")),W=p(x.split("\\")),M=Math.min(q.length,W.length),nt=M,at=0;at<M;at++)if(q[at]!==W[at]){nt=at;break}if(nt==0)return a;var Tt=[];for(at=nt;at<q.length;at++)Tt.push("..");return(Tt=Tt.concat(H.slice(nt))).join("\\")},d._makeLong=function(i){if(!F.isString(i))return i;if(!i)return"";var a=d.resolve(i);return/^[a-zA-Z]\:\\/.test(a)?"\\\\?\\"+a:/^\\\\[^?.]/.test(a)?"\\\\?\\UNC\\"+a.substring(2):i},d.dirname=function(i){var a=I(i),f=a[0],x=a[1];return f||x?(x&&(x=x.substr(0,x.length-1)),f+x):"."},d.basename=function(i,a){var f=I(i)[2];return a&&f.substr(-1*a.length)===a&&(f=f.substr(0,f.length-a.length)),f},d.extname=function(i){return I(i)[3]},d.format=function(i){if(!F.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var a=i.root||"";if(!F.isString(a))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);var f=i.dir,x=i.base||"";return f?f[f.length-1]===d.sep?f+x:f+d.sep+x:x},d.parse=function(i){if(!F.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var a=I(i);if(!a||a.length!==4)throw new TypeError("Invalid path '"+i+"'");return{root:a[0],dir:a[0]+a[1].slice(0,-1),base:a[2],ext:a[3],name:a[2].slice(0,a[2].length-a[3].length)}},d.sep="\\",d.delimiter=";";var B=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,_={};function j(i){return B.exec(i).slice(1)}_.resolve=function(){for(var i="",a=!1,f=arguments.length-1;f>=-1&&!a;f--){var x=f>=0?arguments[f]:T.cwd();if(!F.isString(x))throw new TypeError("Arguments to path.resolve must be strings");x&&(i=x+"/"+i,a=x[0]==="/")}return(a?"/":"")+(i=E(i.split("/"),!a).join("/"))||"."},_.normalize=function(i){var a=_.isAbsolute(i),f=i&&i[i.length-1]==="/";return(i=E(i.split("/"),!a).join("/"))||a||(i="."),i&&f&&(i+="/"),(a?"/":"")+i},_.isAbsolute=function(i){return i.charAt(0)==="/"},_.join=function(){for(var i="",a=0;a<arguments.length;a++){var f=arguments[a];if(!F.isString(f))throw new TypeError("Arguments to path.join must be strings");f&&(i+=i?"/"+f:f)}return _.normalize(i)},_.relative=function(i,a){i=_.resolve(i).substr(1),a=_.resolve(a).substr(1);for(var f=p(i.split("/")),x=p(a.split("/")),H=Math.min(f.length,x.length),q=H,W=0;W<H;W++)if(f[W]!==x[W]){q=W;break}var M=[];for(W=q;W<f.length;W++)M.push("..");return(M=M.concat(x.slice(q))).join("/")},_._makeLong=function(i){return i},_.dirname=function(i){var a=j(i),f=a[0],x=a[1];return f||x?(x&&(x=x.substr(0,x.length-1)),f+x):"."},_.basename=function(i,a){var f=j(i)[2];return a&&f.substr(-1*a.length)===a&&(f=f.substr(0,f.length-a.length)),f},_.extname=function(i){return j(i)[3]},_.format=function(i){if(!F.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var a=i.root||"";if(!F.isString(a))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);return(i.dir?i.dir+_.sep:"")+(i.base||"")},_.parse=function(i){if(!F.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var a=j(i);if(!a||a.length!==4)throw new TypeError("Invalid path '"+i+"'");return a[1]=a[1]||"",a[2]=a[2]||"",a[3]=a[3]||"",{root:a[0],dir:a[0]+a[1].slice(0,-1),base:a[2],ext:a[3],name:a[2].slice(0,a[2].length-a[3].length)}},_.sep="/",_.delimiter=":",$.exports=b?d:_,$.exports.posix=_,$.exports.win32=d},155:$=>{var u,C,T=$.exports={};function b(){throw new Error("setTimeout has not been defined")}function F(){throw new Error("clearTimeout has not been defined")}function E(_){if(u===setTimeout)return setTimeout(_,0);if((u===b||!u)&&setTimeout)return u=setTimeout,setTimeout(_,0);try{return u(_,0)}catch{try{return u.call(null,_,0)}catch{return u.call(this,_,0)}}}(function(){try{u=typeof setTimeout=="function"?setTimeout:b}catch{u=b}try{C=typeof clearTimeout=="function"?clearTimeout:F}catch{C=F}})();var p,l=[],m=!1,d=-1;function I(){m&&p&&(m=!1,p.length?l=p.concat(l):d=-1,l.length&&U())}function U(){if(!m){var _=E(I);m=!0;for(var j=l.length;j;){for(p=l,l=[];++d<j;)p&&p[d].run();d=-1,j=l.length}p=null,m=!1,function(i){if(C===clearTimeout)return clearTimeout(i);if((C===F||!C)&&clearTimeout)return C=clearTimeout,clearTimeout(i);try{C(i)}catch{try{return C.call(null,i)}catch{return C.call(this,i)}}}(_)}}function D(_,j){this.fun=_,this.array=j}function B(){}T.nextTick=function(_){var j=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)j[i-1]=arguments[i];l.push(new D(_,j)),l.length!==1||m||E(U)},D.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=B,T.addListener=B,T.once=B,T.off=B,T.removeListener=B,T.removeAllListeners=B,T.emit=B,T.prependListener=B,T.prependOnceListener=B,T.listeners=function(_){return[]},T.binding=function(_){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(_){throw new Error("process.chdir is not supported")},T.umask=function(){return 0}},384:$=>{$.exports=function(u){return u&&typeof u=="object"&&typeof u.copy=="function"&&typeof u.fill=="function"&&typeof u.readUInt8=="function"}},539:($,u,C)=>{var T=C(155),b=/%[sdj%]/g;u.format=function(s){if(!i(s)){for(var y=[],k=0;k<arguments.length;k++)y.push(p(arguments[k]));return y.join(" ")}k=1;for(var X=arguments,dt=X.length,rt=String(s).replace(b,function(et){if(et==="%%")return"%";if(k>=dt)return et;switch(et){case"%s":return String(X[k++]);case"%d":return Number(X[k++]);case"%j":try{return JSON.stringify(X[k++])}catch{return"[Circular]"}default:return et}}),G=X[k];k<dt;G=X[++k])_(G)||!x(G)?rt+=" "+G:rt+=" "+p(G);return rt},u.deprecate=function(s,y){if(a(C.g.process))return function(){return u.deprecate(s,y).apply(this,arguments)};if(T.noDeprecation===!0)return s;var k=!1;return function(){if(!k){if(T.throwDeprecation)throw new Error(y);T.traceDeprecation?console.trace(y):console.error(y),k=!0}return s.apply(this,arguments)}};var F,E={};function p(s,y){var k={seen:[],stylize:m};return arguments.length>=3&&(k.depth=arguments[2]),arguments.length>=4&&(k.colors=arguments[3]),B(y)?k.showHidden=y:y&&u._extend(k,y),a(k.showHidden)&&(k.showHidden=!1),a(k.depth)&&(k.depth=2),a(k.colors)&&(k.colors=!1),a(k.customInspect)&&(k.customInspect=!0),k.colors&&(k.stylize=l),d(k,s,k.depth)}function l(s,y){var k=p.styles[y];return k?"\x1B["+p.colors[k][0]+"m"+s+"\x1B["+p.colors[k][1]+"m":s}function m(s,y){return s}function d(s,y,k){if(s.customInspect&&y&&W(y.inspect)&&y.inspect!==u.inspect&&(!y.constructor||y.constructor.prototype!==y)){var X=y.inspect(k,s);return i(X)||(X=d(s,X,k)),X}var dt=function(it,Z){if(a(Z))return it.stylize("undefined","undefined");if(i(Z)){var ht="'"+JSON.stringify(Z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return it.stylize(ht,"string")}return j(Z)?it.stylize(""+Z,"number"):B(Z)?it.stylize(""+Z,"boolean"):_(Z)?it.stylize("null","null"):void 0}(s,y);if(dt)return dt;var rt=Object.keys(y),G=function(it){var Z={};return it.forEach(function(ht,wt){Z[ht]=!0}),Z}(rt);if(s.showHidden&&(rt=Object.getOwnPropertyNames(y)),q(y)&&(rt.indexOf("message")>=0||rt.indexOf("description")>=0))return I(y);if(rt.length===0){if(W(y)){var et=y.name?": "+y.name:"";return s.stylize("[Function"+et+"]","special")}if(f(y))return s.stylize(RegExp.prototype.toString.call(y),"regexp");if(H(y))return s.stylize(Date.prototype.toString.call(y),"date");if(q(y))return I(y)}var ot,st="",zt=!1,vt=["{","}"];return D(y)&&(zt=!0,vt=["[","]"]),W(y)&&(st=" [Function"+(y.name?": "+y.name:"")+"]"),f(y)&&(st=" "+RegExp.prototype.toString.call(y)),H(y)&&(st=" "+Date.prototype.toUTCString.call(y)),q(y)&&(st=" "+I(y)),rt.length!==0||zt&&y.length!=0?k<0?f(y)?s.stylize(RegExp.prototype.toString.call(y),"regexp"):s.stylize("[Object]","special"):(s.seen.push(y),ot=zt?function(it,Z,ht,wt,bt){for(var lt=[],Et=0,Xt=Z.length;Et<Xt;++Et)Rt(Z,String(Et))?lt.push(U(it,Z,ht,wt,String(Et),!0)):lt.push("");return bt.forEach(function(R){R.match(/^\d+$/)||lt.push(U(it,Z,ht,wt,R,!0))}),lt}(s,y,k,G,rt):rt.map(function(it){return U(s,y,k,G,it,zt)}),s.seen.pop(),function(it,Z,ht){return it.reduce(function(wt,bt){return bt.indexOf(`
`),wt+bt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ht[0]+(Z===""?"":Z+`
 `)+" "+it.join(`,
  `)+" "+ht[1]:ht[0]+Z+" "+it.join(", ")+" "+ht[1]}(ot,st,vt)):vt[0]+st+vt[1]}function I(s){return"["+Error.prototype.toString.call(s)+"]"}function U(s,y,k,X,dt,rt){var G,et,ot;if((ot=Object.getOwnPropertyDescriptor(y,dt)||{value:y[dt]}).get?et=ot.set?s.stylize("[Getter/Setter]","special"):s.stylize("[Getter]","special"):ot.set&&(et=s.stylize("[Setter]","special")),Rt(X,dt)||(G="["+dt+"]"),et||(s.seen.indexOf(ot.value)<0?(et=_(k)?d(s,ot.value,null):d(s,ot.value,k-1)).indexOf(`
`)>-1&&(et=rt?et.split(`
`).map(function(st){return"  "+st}).join(`
`).substr(2):`
`+et.split(`
`).map(function(st){return"   "+st}).join(`
`)):et=s.stylize("[Circular]","special")),a(G)){if(rt&&dt.match(/^\d+$/))return et;(G=JSON.stringify(""+dt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(G=G.substr(1,G.length-2),G=s.stylize(G,"name")):(G=G.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),G=s.stylize(G,"string"))}return G+": "+et}function D(s){return Array.isArray(s)}function B(s){return typeof s=="boolean"}function _(s){return s===null}function j(s){return typeof s=="number"}function i(s){return typeof s=="string"}function a(s){return s===void 0}function f(s){return x(s)&&M(s)==="[object RegExp]"}function x(s){return typeof s=="object"&&s!==null}function H(s){return x(s)&&M(s)==="[object Date]"}function q(s){return x(s)&&(M(s)==="[object Error]"||s instanceof Error)}function W(s){return typeof s=="function"}function M(s){return Object.prototype.toString.call(s)}function nt(s){return s<10?"0"+s.toString(10):s.toString(10)}u.debuglog=function(s){if(a(F)&&(F=T.env.NODE_DEBUG||""),s=s.toUpperCase(),!E[s])if(new RegExp("\\b"+s+"\\b","i").test(F)){var y=T.pid;E[s]=function(){var k=u.format.apply(u,arguments);console.error("%s %d: %s",s,y,k)}}else E[s]=function(){};return E[s]},u.inspect=p,p.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},p.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},u.isArray=D,u.isBoolean=B,u.isNull=_,u.isNullOrUndefined=function(s){return s==null},u.isNumber=j,u.isString=i,u.isSymbol=function(s){return typeof s=="symbol"},u.isUndefined=a,u.isRegExp=f,u.isObject=x,u.isDate=H,u.isError=q,u.isFunction=W,u.isPrimitive=function(s){return s===null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||typeof s=="symbol"||s===void 0},u.isBuffer=C(384);var at=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Tt(){var s=new Date,y=[nt(s.getHours()),nt(s.getMinutes()),nt(s.getSeconds())].join(":");return[s.getDate(),at[s.getMonth()],y].join(" ")}function Rt(s,y){return Object.prototype.hasOwnProperty.call(s,y)}u.log=function(){console.log("%s - %s",Tt(),u.format.apply(u,arguments))},u.inherits=C(717),u._extend=function(s,y){if(!y||!x(y))return s;for(var k=Object.keys(y),X=k.length;X--;)s[k[X]]=y[k[X]];return s}}},ke={};function pt($){var u=ke[$];if(u!==void 0)return u.exports;var C=ke[$]={exports:{}};return dn[$].call(C.exports,C,C.exports,pt),C.exports}pt.n=$=>{var u=$&&$.__esModule?()=>$.default:()=>$;return pt.d(u,{a:u}),u},pt.d=($,u)=>{for(var C in u)pt.o(u,C)&&!pt.o($,C)&&Object.defineProperty($,C,{enumerable:!0,get:u[C]})},pt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),pt.o=($,u)=>Object.prototype.hasOwnProperty.call($,u),pt.r=$=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty($,Symbol.toStringTag,{value:"Module"}),Object.defineProperty($,"__esModule",{value:!0})};var en={};return(()=>{pt.r(en),pt.d(en,{LSPluginUser:()=>J,setupPluginUserInstance:()=>K});var $=pt(520);pt(856);const u=function(e,t){return e===t||e!=e&&t!=t},C=function(e,t){for(var n=e.length;n--;)if(u(e[n][0],t))return n;return-1};var T=Array.prototype.splice;function b(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}b.prototype.clear=function(){this.__data__=[],this.size=0},b.prototype.delete=function(e){var t=this.__data__,n=C(t,e);return!(n<0||(n==t.length-1?t.pop():T.call(t,n,1),--this.size,0))},b.prototype.get=function(e){var t=this.__data__,n=C(t,e);return n<0?void 0:t[n][1]},b.prototype.has=function(e){return C(this.__data__,e)>-1},b.prototype.set=function(e,t){var n=this.__data__,o=C(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this};const F=b,E=typeof tn=="object"&&tn&&tn.Object===Object&&tn;var p=typeof self=="object"&&self&&self.Object===Object&&self;const l=E||p||Function("return this")(),m=l.Symbol;var d=Object.prototype,I=d.hasOwnProperty,U=d.toString,D=m?m.toStringTag:void 0,B=Object.prototype.toString,_=m?m.toStringTag:void 0;const j=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":_&&_ in Object(e)?function(t){var n=I.call(t,D),o=t[D];try{t[D]=void 0;var c=!0}catch{}var h=U.call(t);return c&&(n?t[D]=o:delete t[D]),h}(e):function(t){return B.call(t)}(e)},i=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},a=function(e){if(!i(e))return!1;var t=j(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},f=l["__core-js_shared__"];var x,H=(x=/[^.]+$/.exec(f&&f.keys&&f.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"",q=Function.prototype.toString,W=/^\[object .+?Constructor\]$/,M=Function.prototype,nt=Object.prototype,at=M.toString,Tt=nt.hasOwnProperty,Rt=RegExp("^"+at.call(Tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const s=function(e){return!(!i(e)||(t=e,H&&H in t))&&(a(e)?Rt:W).test(function(n){if(n!=null){try{return q.call(n)}catch{}try{return n+""}catch{}}return""}(e));var t},y=function(e,t){var n=function(o,c){return o?.[c]}(e,t);return s(n)?n:void 0},k=y(l,"Map"),X=y(Object,"create");var dt=Object.prototype.hasOwnProperty,rt=Object.prototype.hasOwnProperty;function G(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}G.prototype.clear=function(){this.__data__=X?X(null):{},this.size=0},G.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G.prototype.get=function(e){var t=this.__data__;if(X){var n=t[e];return n==="__lodash_hash_undefined__"?void 0:n}return dt.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return X?t[e]!==void 0:rt.call(t,e)},G.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=X&&t===void 0?"__lodash_hash_undefined__":t,this};const et=G,ot=function(e,t){var n,o,c=e.__data__;return((o=typeof(n=t))=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null)?c[typeof t=="string"?"string":"hash"]:c.map};function st(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}st.prototype.clear=function(){this.size=0,this.__data__={hash:new et,map:new(k||F),string:new et}},st.prototype.delete=function(e){var t=ot(this,e).delete(e);return this.size-=t?1:0,t},st.prototype.get=function(e){return ot(this,e).get(e)},st.prototype.has=function(e){return ot(this,e).has(e)},st.prototype.set=function(e,t){var n=ot(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this};const zt=st;function vt(e){var t=this.__data__=new F(e);this.size=t.size}vt.prototype.clear=function(){this.__data__=new F,this.size=0},vt.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},vt.prototype.get=function(e){return this.__data__.get(e)},vt.prototype.has=function(e){return this.__data__.has(e)},vt.prototype.set=function(e,t){var n=this.__data__;if(n instanceof F){var o=n.__data__;if(!k||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new zt(o)}return n.set(e,t),this.size=n.size,this};const it=vt,Z=function(){try{var e=y(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ht=function(e,t,n){t=="__proto__"&&Z?Z(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},wt=function(e,t,n){(n!==void 0&&!u(e[t],n)||n===void 0&&!(t in e))&&ht(e,t,n)},bt=function(e,t,n){for(var o=-1,c=Object(e),h=n(e),g=h.length;g--;){var L=h[++o];if(t(c[L],L,c)===!1)break}return e};var lt=Ft&&!Ft.nodeType&&Ft,Et=lt&&!0&&At&&!At.nodeType&&At,Xt=Et&&Et.exports===lt?l.Buffer:void 0,R=Xt?Xt.allocUnsafe:void 0;const N=l.Uint8Array,A=function(e,t){var n,o,c=t?(n=e.buffer,o=new n.constructor(n.byteLength),new N(o).set(new N(n)),o):e.buffer;return new e.constructor(c,e.byteOffset,e.length)};var Q=Object.create;const tt=function(){function e(){}return function(t){if(!i(t))return{};if(Q)return Q(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Dt=(Fe=Object.getPrototypeOf,qt=Object,function(e){return Fe(qt(e))});var Fe,qt,Ee=Object.prototype;const Qt=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Ee)},Ut=function(e){return e!=null&&typeof e=="object"},Le=function(e){return Ut(e)&&j(e)=="[object Arguments]"};var Ie=Object.prototype,nn=Ie.hasOwnProperty,rn=Ie.propertyIsEnumerable;const ge=Le(function(){return arguments}())?Le:function(e){return Ut(e)&&nn.call(e,"callee")&&!rn.call(e,"callee")},Pt=Array.isArray,Me=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},ye=function(e){return e!=null&&Me(e.length)&&!a(e)};var Ne=Ft&&!Ft.nodeType&&Ft,te=Ne&&!0&&At&&!At.nodeType&&At,ee=te&&te.exports===Ne?l.Buffer:void 0;const Ct=(ee?ee.isBuffer:void 0)||function(){return!1};var Re=Function.prototype,ne=Object.prototype,re=Re.toString,on=ne.hasOwnProperty,an=re.call(Object),V={};V["[object Float32Array]"]=V["[object Float64Array]"]=V["[object Int8Array]"]=V["[object Int16Array]"]=V["[object Int32Array]"]=V["[object Uint8Array]"]=V["[object Uint8ClampedArray]"]=V["[object Uint16Array]"]=V["[object Uint32Array]"]=!0,V["[object Arguments]"]=V["[object Array]"]=V["[object ArrayBuffer]"]=V["[object Boolean]"]=V["[object DataView]"]=V["[object Date]"]=V["[object Error]"]=V["[object Function]"]=V["[object Map]"]=V["[object Number]"]=V["[object Object]"]=V["[object RegExp]"]=V["[object Set]"]=V["[object String]"]=V["[object WeakMap]"]=!1;var ze=Ft&&!Ft.nodeType&&Ft,$t=ze&&!0&&At&&!At.nodeType&&At,yt=$t&&$t.exports===ze&&E.process,oe=function(){try{return $t&&$t.require&&$t.require("util").types||yt&&yt.binding&&yt.binding("util")}catch{}}(),ie=oe&&oe.isTypedArray;const De=ie?function(e){return function(t){return e(t)}}(ie):function(e){return Ut(e)&&Me(e.length)&&!!V[j(e)]},ve=function(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]};var sn=Object.prototype.hasOwnProperty;const Ue=function(e,t,n){var o=e[t];sn.call(e,t)&&u(o,n)&&(n!==void 0||t in e)||ht(e,t,n)};var be=/^(?:0|[1-9]\d*)$/;const ct=function(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&(n=="number"||n!="symbol"&&be.test(e))&&e>-1&&e%1==0&&e<t};var Pe=Object.prototype.hasOwnProperty;const ut=function(e,t){var n=Pt(e),o=!n&&ge(e),c=!n&&!o&&Ct(e),h=!n&&!o&&!c&&De(e),g=n||o||c||h,L=g?function(P,z){for(var Y=-1,mt=Array(P);++Y<P;)mt[Y]=z(Y);return mt}(e.length,String):[],O=L.length;for(var w in e)!t&&!Pe.call(e,w)||g&&(w=="length"||c&&(w=="offset"||w=="parent")||h&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||ct(w,O))||L.push(w);return L};var $e=Object.prototype.hasOwnProperty;const _e=function(e){if(!i(e))return function(c){var h=[];if(c!=null)for(var g in Object(c))h.push(g);return h}(e);var t=Qt(e),n=[];for(var o in e)(o!="constructor"||!t&&$e.call(e,o))&&n.push(o);return n},ae=function(e){return ye(e)?ut(e,!0):_e(e)},He=function(e){return function(t,n,o,c){var h=!o;o||(o={});for(var g=-1,L=n.length;++g<L;){var O=n[g],w=c?c(o[O],t[O],O,o,t):void 0;w===void 0&&(w=t[O]),h?ht(o,O,w):Ue(o,O,w)}return o}(e,ae(e))},we=function(e,t,n,o,c,h,g){var L,O=ve(e,n),w=ve(t,n),P=g.get(w);if(P)wt(e,n,P);else{var z=h?h(O,w,n+"",e,t,g):void 0,Y=z===void 0;if(Y){var mt=Pt(w),Te=!mt&&Ct(w),je=!mt&&!Te&&De(w);z=w,mt||Te||je?Pt(O)?z=O:Ut(L=O)&&ye(L)?z=function(ft,_t){var gt=-1,Yt=ft.length;for(_t||(_t=Array(Yt));++gt<Yt;)_t[gt]=ft[gt];return _t}(O):Te?(Y=!1,z=function(ft,_t){if(_t)return ft.slice();var gt=ft.length,Yt=R?R(gt):new ft.constructor(gt);return ft.copy(Yt),Yt}(w,!0)):je?(Y=!1,z=A(w,!0)):z=[]:function(ft){if(!Ut(ft)||j(ft)!="[object Object]")return!1;var _t=Dt(ft);if(_t===null)return!0;var gt=on.call(_t,"constructor")&&_t.constructor;return typeof gt=="function"&&gt instanceof gt&&re.call(gt)==an}(w)||ge(w)?(z=O,ge(O)?z=He(O):i(O)&&!a(O)||(z=function(ft){return typeof ft.constructor!="function"||Qt(ft)?{}:tt(Dt(ft))}(w))):Y=!1}Y&&(g.set(w,z),c(z,w,o,h,g),g.delete(w)),wt(e,n,z)}},Be=function e(t,n,o,c,h){t!==n&&bt(n,function(g,L){if(h||(h=new it),i(g))we(t,n,L,o,e,c,h);else{var O=c?c(ve(t,L),g,L+"",t,n,h):void 0;O===void 0&&(O=g),wt(t,L,O)}},ae)},Lt=function(e){return e},Ht=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var se=Math.max;const Ce=Z?function(e,t){return Z(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Lt;var Bt=Date.now;const ce=function(e){var t=0,n=0;return function(){var o=Bt(),c=16-(o-n);if(n=o,c>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Ce),We=(le=function(e,t,n){Be(e,t,n)},function(e,t){return ce(function(n,o,c){return o=se(o===void 0?n.length-1:o,0),function(){for(var h=arguments,g=-1,L=se(h.length-o,0),O=Array(L);++g<L;)O[g]=h[o+g];g=-1;for(var w=Array(o+1);++g<o;)w[g]=h[g];return w[o]=c(O),Ht(n,this,w)}}(e,t,Lt),e+"")}(function(e,t){var n=-1,o=t.length,c=o>1?t[o-1]:void 0,h=o>2?t[2]:void 0;for(c=le.length>3&&typeof c=="function"?(o--,c):void 0,h&&function(L,O,w){if(!i(w))return!1;var P=typeof O;return!!(P=="number"?ye(w)&&ct(O,w.length):P=="string"&&O in w)&&u(w[O],L)}(t[0],t[1],h)&&(c=o<3?void 0:c,o=1),e=Object(e);++n<o;){var g=t[n];g&&le(e,g,n)}return e})),Zt=navigator.platform.toLowerCase()==="win32"?$.win32:$.posix;var le;const xe=We;function It(e,t){let n,o,c=!1;const h=L=>O=>{e&&clearTimeout(e),L(O),c=!0},g=new Promise((L,O)=>{n=h(L),o=h(O),e&&(e=setTimeout(()=>o(new Error(`[deferred timeout] ${t}`)),e))});return{created:Date.now(),setTag:L=>t=L,resolve:n,reject:o,promise:g,get settled(){return c}}}var Wt=pt(227),Mt=pt.n(Wt);const jt="application/x-postmate-v1+json";let Ge=0;const Je={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},Vt=(e,t)=>!(typeof t=="string"&&e.origin!==t||!e.data||typeof e.data=="object"&&!("postmate"in e.data)||e.data.type!==jt||!Je[e.data.postmate]);class qe{parent;frame;child;events={};childOrigin;listener;constructor(t){this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=n=>{if(!Vt(n,this.childOrigin))return!1;const{data:o,name:c}=((n||{}).data||{}).value||{};n.data.postmate==="emit"&&c in this.events&&this.events[c].forEach(h=>{h.call(this,o)})},this.parent.addEventListener("message",this.listener,!1)}get(t){return new Promise(n=>{const o=++Ge,c=h=>{h.data.uid===o&&h.data.postmate==="reply"&&(this.parent.removeEventListener("message",c,!1),n(h.data.value))};this.parent.addEventListener("message",c,!1),this.child.postMessage({postmate:"request",type:jt,property:t,uid:o},this.childOrigin)})}call(t,n){this.child.postMessage({postmate:"call",type:jt,property:t,data:n},this.childOrigin)}on(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class Se{model;parent;parentOrigin;child;constructor(t){this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",n=>{if(!Vt(n,this.parentOrigin))return;const{property:o,uid:c,data:h}=n.data;n.data.postmate!=="call"?((g,L)=>{const O=typeof g[L]=="function"?g[L]():g[L];return Promise.resolve(O)})(this.model,o).then(g=>{n.source.postMessage({property:o,postmate:"reply",type:jt,uid:c,value:g},n.origin)}):o in this.model&&typeof this.model[o]=="function"&&this.model[o](h)})}emit(t,n){this.parent.postMessage({postmate:"emit",type:jt,value:{name:t,data:n}},this.parentOrigin)}}class Oe{static debug=!1;container;parent;frame;child;childOrigin;url;model;static Model;constructor(t){this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const n=(h=>{const g=document.createElement("a");g.href=h;const L=g.protocol.length>4?g.protocol:window.location.protocol,O=g.host.length?g.port==="80"||g.port==="443"?g.hostname:g.host:window.location.host;return g.origin||`${L}//${O}`})(t=t||this.url);let o,c=0;return new Promise((h,g)=>{const L=w=>!!Vt(w,n)&&(w.data.postmate==="handshake-reply"?(clearInterval(o),this.parent.removeEventListener("message",L,!1),this.childOrigin=w.origin,h(new qe(this))):g("Failed handshake"));this.parent.addEventListener("message",L,!1);const O=()=>{c++,this.child.postMessage({postmate:"handshake",type:jt,model:this.model},n),c===5&&clearInterval(o)};this.frame.addEventListener("load",()=>{O(),o=setInterval(O,500)}),this.frame.src=t})}}class kt{child;model;parent;parentOrigin;constructor(t){this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((t,n)=>{const o=c=>{if(c.data.postmate){if(c.data.postmate==="handshake"){this.child.removeEventListener("message",o,!1),c.source.postMessage({postmate:"handshake-reply",type:jt},c.origin),this.parentOrigin=c.origin;const h=c.data.model;return h&&Object.keys(h).forEach(g=>{this.model[g]=h[g]}),t(new Se(this))}return n("Handshake Reply Failed")}};this.child.addEventListener("message",o,!1)})}}var ue=pt(729),fe=pt.n(ue);const{importHTML:Gt,createSandboxContainer:cn}=window.QSandbox||{};function Ae(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise(async(n,o)=>{try{const c=await window.apis.doAction(["readFile",e]);n({text:()=>c})}catch(c){console.error(c),o(c)}}))}class Ze extends fe(){_pluginLocal;_frame;_root;_loaded=!1;_unmountFns=[];constructor(t){super(),this._pluginLocal=t,t._dispose(()=>{this._unmount()})}async load(){const{name:t,entry:n}=this._pluginLocal.options;if(this.loaded||!n)return;const{template:o,execScripts:c}=await Gt(n,{fetch:Ae});this._mount(o,document.body);const h=cn(t,{elementGetter:()=>this._root?.firstChild}).instance.proxy;h.__shadow_mode__=!0,h.LSPluginLocal=this._pluginLocal,h.LSPluginShadow=this,h.LSPluginUser=h.logseq=new J(this._pluginLocal.toJSON(),this._pluginLocal.caller);const g=await c(h,!0);this._unmountFns.push(g.unmount),this._loaded=!0}_mount(t,n){const o=this._frame=document.createElement("div");o.classList.add("lsp-shadow-sandbox"),o.id=this._pluginLocal.id,this._root=o.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,n.appendChild(o),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){this.frame?.parentNode?.removeChild(this.frame)}get loaded(){return this._loaded}get document(){return this._root?.firstChild}get frame(){return this._frame}}const xt=Mt()("LSPlugin:caller"),Nt="#await#response#",pe="#lspmsg#error#",de=e=>`#lspmsg#${e}`;class St extends fe(){_pluginLocal;_connected=!1;_parent;_child;_shadow;_status;_userModel={};_call;_callUserModel;_debugTag="";constructor(t){super(),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const n=this,o=this._pluginLocal!=null;let c=0;const h=new Map,g=It(5e3),L=this._extendUserModel({"#lspmsg#ready#":async w=>{L[de(w?.pid)]=({type:P,payload:z})=>{xt(`[call from host (_call)] ${this._debugTag}`,P,z),n.emit(P,z)},await g.resolve()},"#lspmsg#beforeunload#":async w=>{const P=It(1e4);n.emit("beforeunload",Object.assign({actor:P},w)),await P.promise},"#lspmsg#settings#":async({type:w,payload:P})=>{n.emit("settings:changed",P)},"#lspmsg#":async({ns:w,type:P,payload:z})=>{xt(`[call from host (async)] ${this._debugTag}`,w,P,z),w&&w.startsWith("hook")?n.emit(`${w}:${P}`,z):n.emit(P,z)},"#lspmsg#reply#":({_sync:w,result:P})=>{if(xt(`[sync reply] #${w}`,P),h.has(w)){const z=h.get(w);z&&(P?.hasOwnProperty(pe)?z.reject(P[pe]):z.resolve(P),h.delete(w))}},...t});if(o)return await g.promise,JSON.parse(JSON.stringify(this._pluginLocal?.toJSON()));const O=new kt(L).sendHandshakeReply();return this._status="pending",await O.then(w=>{this._child=w,this._connected=!0,this._call=async(P,z={},Y)=>{if(Y){const mt=++c;h.set(mt,Y),z._sync=mt,Y.setTag(`async call #${mt}`),xt("async call #",mt)}return w.emit(de(L.baseInfo.id),{type:P,payload:z}),Y?.promise},this._callUserModel=async(P,z)=>{try{L[P](z)}catch{xt(`[model method] #${P} not existed`)}},setInterval(()=>{if(h.size>100)for(const[P,z]of h)z.settled&&h.delete(P)},18e5)}).finally(()=>{this._status=void 0}),await g.promise,L.baseInfo}async call(t,n={}){return this._call?.call(this,t,n)}async callAsync(t,n={}){const o=It(1e4);return this._call?.call(this,t,n,o)}async callUserModel(t,n={}){return this._callUserModel?.call(this,t,n)}async _setupIframeSandbox(){const t=this._pluginLocal,n=t.id,o=new URL(t.options.entry);o.searchParams.set("__v__",t.options.version);const c=document.querySelector(`#${n}`);c&&c.parentElement.removeChild(c);const h=document.createElement("div");h.classList.add("lsp-iframe-sandbox-container"),h.id=n;try{const O=(await this._pluginLocal._loadLayoutsData())?.$$0;if(O){h.dataset.inited_layout="true";const{width:w,height:P,left:z,top:Y}=O;Object.assign(h.style,{width:w+"px",height:P+"px",left:z+"px",top:Y+"px"})}}catch(O){console.error("[Restore Layout Error]",O)}document.body.appendChild(h);let g,L=new Oe({id:n+"_iframe",container:h,url:o.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}}).sendHandshake();return this._status="pending",new Promise((O,w)=>{g=setTimeout(()=>{w(new Error("handshake Timeout"))},3e3),L.then(P=>{this._parent=P,this._connected=!0,this.emit("connected"),P.on(de(t.id),({type:z,payload:Y})=>{xt("[call from plugin] ",z,Y),this._pluginLocal?.emit(z,Y||{})}),this._call=async(...z)=>{await P.call(de(t.id),{type:z[0],payload:Object.assign(z[1]||{},{$$pid:t.id})})},this._callUserModel=async(z,Y)=>{if(z.startsWith(Nt))return await P.get(z.replace(Nt,""));P.call(z,Y)},O(null)}).catch(P=>{w(P)}).finally(()=>{clearTimeout(g)})}).catch(O=>{throw xt("[iframe sandbox] error",O),O}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const t=this._pluginLocal,n=this._shadow=new Ze(t);try{this._status="pending",await n.load(),this._connected=!0,this.emit("connected"),this._call=async(o,c={},h)=>(h&&(c.actor=h),this._pluginLocal?.emit(o,Object.assign(c,{$$pid:t.id})),h?.promise),this._callUserModel=async(...o)=>{let c=o[0];c?.startsWith(Nt)&&(c=c.replace(Nt,""));const h=o[1]||{},g=this._userModel[c];typeof g=="function"&&await g.call(null,h)}}catch(o){throw xt("[shadow sandbox] error",o),o}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){return this._parent?.frame.parentNode}_getSandboxShadowContainer(){return this._shadow?.frame.parentNode}_getSandboxIframeRoot(){return this._parent?.frame}_getSandboxShadowRoot(){return this._shadow?.frame}set debugTag(t){this._debugTag=t}async destroy(){let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),t?.parentNode.removeChild(t)}}var he=function(){return(he=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var c in t=arguments[n])Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e}).apply(this,arguments)};function Ve(e){return e.toLowerCase()}var Ke=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],ln=/[^A-Z0-9]+/gi;function Jt(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce(function(o,c){return o.replace(c,n)},e)}class Ot{ctx;constructor(t){this.ctx=t}get ctxId(){return this.ctx.baseInfo.id}setItem(t,n){return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,n]})}getItem(t){return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t]})}removeItem(t){return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t]})}clear(){return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId]})}hasItem(t){return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t]})}}const Ye=Symbol.for("proxy-continue"),Xe=Mt()("LSPlugin:user");function Kt(e,t,n){if(typeof n!="function")return!1;const{key:o,label:c,desc:h,palette:g,keybinding:L}=t,O=`SimpleCommandHook${o}${++r}`;this.Editor["on"+O](n),this.caller?.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:o,label:c,type:e,desc:h,keybinding:L},["editor/hook",O]],g]})}const un={registerCommand:Kt,registerCommandPalette(e,t){const{key:n,label:o,keybinding:c}=e;return Kt.call(this,"global-palette-command",{key:n,label:o,palette:!0,keybinding:c},t)},registerUIItem(e,t){const n=this.baseInfo.id;this.caller?.call("api:call",{method:"register-plugin-ui-item",args:[n,e,t]})},registerPageMenuItem(e,t){if(typeof t!="function")return!1;const n=e+"_"+this.baseInfo.id,o=e;Kt.call(this,"page-menu-item",{key:n,label:o},t)},setFullScreen(e){const t=(...n)=>this._callWin("setFullScreen",...n);e==="toggle"?this._callWin("isFullScreen").then(n=>{n?t():t(!0)}):e?t(!0):t()}};let r=0;const S={registerSlashCommand(e,t){Xe("Register slash command #",this.baseInfo.id,e,t),typeof t=="function"&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map(n=>{const[o,...c]=n;switch(o){case"editor/hook":let h=c[0],g=()=>{this.caller?.callUserModel(h)};typeof h=="function"&&(g=h);const L=`SlashCommandHook${o}${++r}`;n[1]=L,this.Editor["on"+L](g)}return n}),this.caller?.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if(typeof t!="function")return!1;const n=e+"_"+this.baseInfo.id,o=e;Kt.call(this,"block-context-menu-item",{key:n,label:o},t)},scrollToBlockInPage(e,t){const n="block-content-"+t;this.App.pushState("page",{name:e},{anchor:n})}},v={};class J extends fe(){_baseInfo;_caller;_settingsSchema;_connected=!1;_ui=new Map;_fileStorage;_beforeunloadCallback;constructor(t,n){super(),this._baseInfo=t,this._caller=n,n.on("sys:ui:visible",o=>{o?.toggle&&this.toggleMainUI()}),n.on("settings:changed",o=>{const c=Object.assign({},this.settings),h=Object.assign(this._baseInfo.settings,o);this.emit("settings:changed",{...h},c)}),n.on("beforeunload",async o=>{const{actor:c,...h}=o,g=this._beforeunloadCallback;try{g&&await g(h),c?.resolve(null)}catch(L){console.debug(`${n.debugTag} [beforeunload] `,L),c?.reject(L)}}),this._fileStorage=new Ot(this)}async ready(t,n){if(!this._connected)try{typeof t=="function"&&(n=t,t={});let o=await this._caller.connectToParent(t);this._connected=!0,o=xe(this._baseInfo,o),this._settingsSchema&&(o.settings=function(c,h){const g=(h||[]).reduce((L,O)=>("default"in O&&(L[O.key]=O.default),L),{});return Object.assign(g,c)}(o.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema)),o?.id&&(this._caller.debugTag=`#${o.id} [${o.name}]`),n&&n.call(this,o)}catch(o){console.error("[LSPlugin Ready Error]",o)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){typeof t=="function"&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const n="settings:changed";return this.on(n,t),()=>this.off(n,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const n={key:0,visible:!1,cursor:t?.restoreEditingCursor};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}showMainUI(t){const n={key:0,visible:!0,autoFocus:t?.autoFocus};this.caller.call("main-ui:visible",n),this.emit("ui:visible:changed",n),this._ui.set(n.key,n)}toggleMainUI(){const t=this._ui.get(0);t&&t.visible?this.hideMainUI():this.showMainUI()}get isMainUIVisible(){const t=this._ui.get(0);return Boolean(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get settings(){return this.baseInfo?.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),function(n,...o){try{const c=new URL(n);if(!c.origin)throw new Error(null);const h=Zt.join(n.substr(c.origin.length),...o);return c.origin+h}catch{return Zt.join(n,...o)}}(this._baseInfo.lsr,t)}_makeUserProxy(t,n){const o=this,c=this.caller;return new Proxy(t,{get(h,g,L){const O=h[g];return function(...w){if(!O||O.apply(o,w)===Ye){if(n){const Y=g.toString().match(/^(once|off|on)/i);if(Y!=null){const mt=Y[0].toLowerCase(),Te=Y.input.slice(mt.length),je=`hook:${n}:${P=Te,z===void 0&&(z={}),function(_t,gt){return gt===void 0&&(gt={}),function(Yt,me){me===void 0&&(me={});for(var hn=me.splitRegexp,bn=hn===void 0?Ke:hn,mn=me.stripRegexp,_n=mn===void 0?ln:mn,gn=me.transform,wn=gn===void 0?Ve:gn,yn=me.delimiter,Cn=yn===void 0?" ":yn,Qe=Jt(Jt(Yt,bn,"$1\0$2"),_n,"\0"),fn=0,pn=Qe.length;Qe.charAt(fn)==="\0";)fn++;for(;Qe.charAt(pn-1)==="\0";)pn--;return Qe.slice(fn,pn).split("\0").map(wn).join(Cn)}(_t,he({delimiter:"."},gt))}(P,he({delimiter:"_"},z))}`,ft=w[0];return c[mt](je,ft),mt!=="off"?()=>c.off(je,ft):void 0}}var P,z;return c.callAsync("api:call",{tag:n,method:g,args:w})}}}})}_callWin(...t){return this._caller.callAsync("api:call",{method:"_callMainWin",args:t})}get App(){return this._makeUserProxy(un,"app")}get Editor(){return this._makeUserProxy(S,"editor")}get DB(){return this._makeUserProxy(v)}get FileStorage(){return this._fileStorage}}function K(e,t){return new J(e,t)}if(window.__LSP__HOST__==null){const e=new St(null);window.logseq=K({},e)}})(),en})()})})(vn,vn.exports);
